<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{/views/layout::dynamic(~{::body})}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link
	href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap"
	rel="stylesheet">

<link rel="stylesheet" href="/views/css/open-iconic-bootstrap.min.css">
<link rel="stylesheet" href="/views/css/animate.css">

<link rel="stylesheet" href="/views/css/owl.carousel.min.css">
<link rel="stylesheet" href="/views/css/owl.theme.default.min.css">
<link rel="stylesheet" href="/views/css/magnific-popup.css">

<link rel="stylesheet" href="/views/css/aos.css">

<link rel="stylesheet" href="/views/css/ionicons.min.css">

<link rel="stylesheet" href="/views/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="/views/css/jquery.timepicker.css">


<link rel="stylesheet" href="/views/css/flaticon.css">
<link rel="stylesheet" href="/views/css/icomoon.css">
<link rel="stylesheet" href="/views/css/style.css">
</head>
<body>

	<section class="hero-wrap hero-wrap-2 js-fullheight"
		style="background-image: url('/images/bg_3.jpg');"
		data-stellar-background-ratio="0.5">
		<div class="overlay"></div>
		<div class="container">
			<div
				class="row no-gutters slider-text js-fullheight align-items-end justify-content-start">
				<div class="col-md-9 ftco-animate pb-5">
					<p class="breadcrumbs">
						<span class="mr-2"><a href="index.html">Home <i
								class="ion-ios-arrow-forward"></i></a></span> <span>Cars <i
							class="ion-ios-arrow-forward"></i></span>
					</p>
					<h1 class="mb-3 bread">Choose Your Car</h1>
				</div>
			</div>
		</div>
	</section>


	<section class="ftco-section bg-light">
		<div class="container">
			<div class="row">
				<div class="col-md-4" th:each="car : ${cars}">
					<div class="car-wrap rounded ftco-animate">
						<div class="img rounded d-flex align-items-end"
							style="position: relative; width: 348px; height: 200px; overflow: hidden;">
							<!-- Hiển thị ảnh nếu có -->
							<img th:src="@{${car.imageCar.image1}}" alt="Car Image 1"
								style="width: 100%; height: auto; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-size: cover">
						</div>
						<div class="text">
							<h2 class="mb-0">
								<a href="#">[[${car.carName}]]</a>
							</h2>
							<div class="d-flex mb-3">
								<span class="cat" style="color: blue">[[${car.carBrand.brandName}]]</span>
								<p class="price ml-auto">
									[[${car.priceHoursCar}]] <span>/day</span>
								</p>
							</div>
							<div class="d-flex justify-content-between">
								<h5>[[${car.address}]]</h5>
								<p>[[${car.status} ? 'Free' : 'Busy']]</p>
							</div>
							<p class="d-flex mb-0 d-block">
								<a th:href="@{/booking/views/Booking(carID=${car.carID})}"
									class="btn btn-outline-dark flex-shrink-0"> <i
									class="bi-cart-fill me-1"></i> Book now
								</a> <a th:href="@{/index/cars/{id}(id=${car.carID})}"
									class="btn btn-secondary py-2 ml-1">Details</a>
								<button class="btn btn-primary ml-1"
									onclick="showDirections('[[${car.address}]]');">Get
									Directions</button>
							</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="map"
			style="height: 500px; width: 100%; margin-top: 20px; display: none;"></div>

		<!-- <div class="col text-center">
            <div class="block-27">
              <ul>
                <li><a href="#">&lt;</a></li>
                <li class="active"><span>1</span></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li><a href="#">&gt;</a></li>
              </ul>
            </div> 
          </div> -->
		</div>
		</div>
	</section>
	<!-- loader -->
	<div id="ftco-loader" class="show fullscreen">
		<svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke="#eeeeee" />
			<circle class="path" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg>
	</div>

	<script>
let map;
let directionsService;
let directionsRenderer;

function initMap() {
    // Khởi tạo bản đồ và các dịch vụ
    map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: -34.397, lng: 150.644 }, // Điểm mặc định
        zoom: 8,
    });
    directionsService = new google.maps.DirectionsService();
    directionsRenderer = new google.maps.DirectionsRenderer();
    directionsRenderer.setMap(map);
}

function showDirections(destinationAddress) {
    // Hiển thị bản đồ
    document.getElementById("map").style.display = "block";

    // Lấy vị trí hiện tại của người dùng
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((position) => {
            const userLocation = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
            };

            // Tính toán đường đi
            const request = {
                origin: userLocation, // Vị trí hiện tại của người dùng
                destination: destinationAddress, // Địa chỉ của xe
                travelMode: google.maps.TravelMode.DRIVING, // Phương thức di chuyển
            };

            directionsService.route(request, (result, status) => {
                if (status === google.maps.DirectionsStatus.OK) {
                    directionsRenderer.setDirections(result);
                } else {
                    alert("Không thể tìm thấy đường đi: " + status);
                }
            });
        }, (error) => {
            alert("Không thể lấy vị trí của bạn. Hãy bật định vị trên thiết bị.");
        });
    } else {
        alert("Trình duyệt của bạn không hỗ trợ định vị.");
    }
}
</script>
	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6ZInLFqOezQwiwSFtcb5axfkG-0Awjaw&callback=initMap"></script>
	<script src="/views/js/jquery.min.js"></script>
	<script src="/views/js/jquery-migrate-3.0.1.min.js"></script>
	<script src="/views/js/popper.min.js"></script>
	<script src="/views/js/bootstrap.min.js"></script>
	<script src="/views/js/jquery.easing.1.3.js"></script>
	<script src="/views/js/jquery.waypoints.min.js"></script>
	<script src="/views/js/jquery.stellar.min.js"></script>
	<script src="/views/js/owl.carousel.min.js"></script>
	<script src="/views/js/jquery.magnific-popup.min.js"></script>
	<script src="/views/js/aos.js"></script>
	<script src="/views/js/jquery.animateNumber.min.js"></script>
	<script src="/views/js/bootstrap-datepicker.js"></script>
	<script src="/views/js/jquery.timepicker.min.js"></script>
	<script src="/views/js/scrollax.min.js"></script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6ZInLFqOezQwiwSFtcb5axfkG-0Awjaw&sensor=false"></script>
	<script src="/views/js/google-map.js"></script>
	<script src="/views/js/main.js"></script>
</body>
</html>