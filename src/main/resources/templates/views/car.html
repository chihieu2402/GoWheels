<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{/views/layout::dynamic(~{::body})}">
<head>
<meta charset="UTF-8">
<title>Choose Your Car</title>
<link rel="stylesheet" href="/views/css/open-iconic-bootstrap.min.css">
<link rel="stylesheet" href="/views/css/animate.css">
<link rel="stylesheet" href="/views/css/owl.carousel.min.css">
<link rel="stylesheet" href="/views/css/owl.theme.default.min.css">
<link rel="stylesheet" href="/views/css/magnific-popup.css">
<link rel="stylesheet" href="/views/css/aos.css">
<link rel="stylesheet" href="/views/css/ionicons.min.css">
<link rel="stylesheet" href="/views/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="/views/css/jquery.timepicker.css">
<link rel="stylesheet" href="/views/css/flaticon.css">
<link rel="stylesheet" href="/views/css/icomoon.css">
<link rel="stylesheet" href="/views/css/style.css">
<script
	src="https://cdn.jsdelivr.net/npm/@goongmaps/goong-js@1.0.9/dist/goong-js.js"></script>
<link
	href="https://cdn.jsdelivr.net/npm/@goongmaps/goong-js@1.0.9/dist/goong-js.css"
	rel="stylesheet" />
</head>
<body>

	<section class="hero-wrap hero-wrap-2 js-fullheight"
		style="background-image: url('/images/bg_3.jpg');"
		data-stellar-background-ratio="0.5">
		<div class="overlay"></div>
		<div class="container">
			<div
				class="row no-gutters slider-text js-fullheight align-items-end justify-content-start">
				<div class="col-md-9 ftco-animate pb-5">
					<p class="breadcrumbs">
						<span class="mr-2"><a href="index.html">Home <i
								class="ion-ios-arrow-forward"></i></a></span> <span>Cars <i
							class="ion-ios-arrow-forward"></i></span>
					</p>
					<h1 class="mb-3 bread">Choose Your Car</h1>
				</div>
			</div>
		</div>
	</section>

	<section class="ftco-section bg-light">
		<div class="container">
			<div class="row">
				<div class="col-md-4" th:each="car : ${cars}">
					<div class="car-wrap rounded ftco-animate">
						<div class="img rounded d-flex align-items-end"
							style="position: relative; width: 348px; height: 200px; overflow: hidden;">
							<img th:src="@{'/images/'+${car.imageCar.image1}}"
								alt="Car Image 1"
								style="width: 100%; height: auto; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-size: cover">

							<!-- Hiển thị ảnh nếu có -->
							
						<span th:if="${car.imageCar != null and car.imageCar.image1 != null}">
                            <img th:src="@{/images/{image}(image=${car.imageCar.image1})}" alt="Car Image 1" style="width: 100%; height: auto; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-size: cover">
                        </span>

						</div>
						
						<div class="text">
							<h2 class="mb-0">
								<a href="#">[[${car.carName}]]</a>
							</h2>
							<div class="d-flex mb-3">
								<span class="cat" style="color: blue">[[${car.carBrand.brandName}]]</span>
								<p class="price ml-auto">
									[[${car.priceHoursCar}]] <span>/day</span>
								</p>
							</div>
							<div class="d-flex justify-content-between">
								<h5>[[${car.address}]]</h5>
								<p>[[${car.status} ? 'Free' : 'Busy']]</p>
							</div>
							<p class="d-flex mb-0 d-block">
								<a th:href="@{/booking/views/Booking(carID=${car.carID})}"
									class="btn btn-outline-dark flex-shrink-0"> <i
									class="bi-cart-fill me-1"></i> Book now
								</a> <a th:href="@{/index/cars/{id}(id=${car.carID})}"
									class="btn btn-secondary py-2 ml-1">Details</a>
								<button class="btn btn-primary ml-1"
									onclick="getDirections('[[${car.address}]]')">Get
									Directions</button>
							</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Thêm thẻ div để chứa bản đồ -->
			<div id="map" style="width: 100%; height: 400px;"></div>
		</div>
	</section>

	<!-- Loader -->
	<div id="ftco-loader" class="show fullscreen">
		<svg class="circular" width="48px" height="48px">
            <circle class="path-bg" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke="#eeeeee" />
            <circle class="path" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" />
        </svg>
	</div>

	<script src="/views/js/jquery.min.js"></script>
	<script src="/views/js/bootstrap.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/@goongmaps/goong-js@1.0.9/dist/goong-js.js"></script>

	<script>
		//Khóa API cho các dịch vụ
		goongjs.accessToken = "68SRPQ62BQWhy944tPzQhrM9i0O7gAP7rbiSjWel"; // Khóa API

		// Khởi tạo bản đồ với khóa tiles
/* 		const map = ne=w goongjs.Map(
				{
					container : "map",
					style : "https://tiles.goong.io/assets/goong_map_web.json?accessToken=it192E23DCpOUmf7zu5rpeArJzfCDRG8xp1OsYLh", // Khóa bản đồ tiles
					center : {
						lat : 20.99245,
						lng : 105.80278
					}, // Ví dụ tọa độ
					zoom : 11.5,
				});

		// Hàm lấy chỉ đường
		function getDirections(address) {
			// Lấy vị trí hiện tại của người dùng
			if (navigator.geolocation) {
				navigator.geolocation
						.getCurrentPosition(
								function(position) {
									const currentLat = position.coords.latitude;
									const currentLng = position.coords.longitude;

									const geocoder = new goongjs.Geocoder();
									geocoder
											.geocode(
													{
														address : address
													},
													function(results, status) {
														if (status === 'OK') {
															const destinationLat = results[0].geometry.location
																	.lat();
															const destinationLng = results[0].geometry.location
																	.lng();

															const directionsService = new goongjs.DirectionsService();
															const directionsRenderer = new goongjs.DirectionsRenderer();
															directionsRenderer
																	.setMap(map);

															const request = {
																origin : new goongjs.LatLng(
																		currentLat,
																		currentLng),
																destination : new goongjs.LatLng(
																		destinationLat,
																		destinationLng),
																travelMode : goongjs.TravelMode.DRIVING
															};

															directionsService
																	.route(
																			request,
																			function(
																					result,
																					status) {
																				if (status === 'OK') {
																					directionsRenderer
																							.setDirections(result);
																				} else {
																					alert('Error getting directions: '
																							+ status);
																				}
																			});
														} else {
															alert('Unable to geocode the address: '
																	+ status);
														}
													});
								},
								function() {
									alert('Geolocation failed or is not supported by your browser.');
								});
			} else {
				alert('Geolocation is not supported by your browser.');
			}
		} */
	</script>
</body>
</html>
